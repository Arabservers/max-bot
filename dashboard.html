<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Max Bot â€” Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
    <meta name="theme-color" content="#5865F2">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        :root {
            --bg: #0a0a1a;
            --card: #12122a;
            --glass: rgba(255, 255, 255, .05);
            --border: rgba(255, 255, 255, .08);
            --text: #e0e0e0;
            --dim: #888;
            --blue: #5865F2;
            --green: #57F287;
            --red: #ED4245;
            --yellow: #FEE75C;
            --purple: #9b59b6
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh
        }

        a {
            color: var(--blue);
            text-decoration: none
        }

        .top-bar {
            background: rgba(10, 10, 26, .95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100
        }

        .top-bar h1 {
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px
        }

        .top-bar h1 span {
            background: var(--blue);
            color: #fff;
            padding: 2px 10px;
            border-radius: 8px;
            font-size: .75rem
        }

        .back-btn {
            color: var(--dim);
            font-size: .9rem;
            transition: .3s
        }

        .back-btn:hover {
            color: #fff
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px
        }

        .guild-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 32px;
            padding: 24px;
            background: var(--card);
            border-radius: 16px;
            border: 1px solid var(--border)
        }

        .guild-icon {
            width: 72px;
            height: 72px;
            border-radius: 16px;
            overflow: hidden;
            background: var(--glass);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px
        }

        .guild-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover
        }

        .guild-info h2 {
            font-size: 1.6rem;
            font-weight: 800
        }

        .guild-info p {
            color: var(--dim);
            font-size: .9rem;
            margin-top: 4px
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin-bottom: 32px
        }

        .stat-box {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            text-align: center
        }

        .stat-box .num {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 4px
        }

        .stat-box .lbl {
            color: var(--dim);
            font-size: .85rem
        }

        .blue {
            color: var(--blue)
        }

        .green {
            color: var(--green)
        }

        .yellow {
            color: var(--yellow)
        }

        .purple {
            color: var(--purple)
        }

        .red {
            color: var(--red)
        }

        .section {
            margin-bottom: 32px
        }

        .section h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px
        }

        .setting-item {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center
        }

        .setting-item .name {
            font-size: .9rem
        }

        .setting-item .val {
            font-size: .85rem;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700
        }

        .val.on {
            background: rgba(87, 242, 135, .15);
            color: var(--green)
        }

        .val.off {
            background: rgba(237, 66, 69, .15);
            color: var(--red)
        }

        .lb-list {
            display: flex;
            flex-direction: column;
            gap: 8px
        }

        .lb-row {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 16px;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 10px
        }

        .lb-rank {
            width: 28px;
            font-weight: 800;
            font-size: .9rem;
            color: var(--blue)
        }

        .lb-av {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            overflow: hidden;
            background: var(--glass)
        }

        .lb-av img {
            width: 100%;
            height: 100%;
            object-fit: cover
        }

        .lb-name {
            flex: 1;
            font-size: .9rem
        }

        .lb-val {
            font-weight: 700;
            font-size: .85rem;
            color: var(--yellow)
        }

        .sug-list {
            display: flex;
            flex-direction: column;
            gap: 10px
        }

        .sug-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px
        }

        .sug-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px
        }

        .sug-id {
            font-weight: 700;
            color: var(--blue);
            font-size: .85rem
        }

        .sug-status {
            font-size: .75rem;
            padding: 3px 10px;
            border-radius: 20px;
            font-weight: 700
        }

        .sug-status.pending {
            background: rgba(254, 231, 92, .12);
            color: var(--yellow)
        }

        .sug-status.approved {
            background: rgba(87, 242, 135, .12);
            color: var(--green)
        }

        .sug-status.rejected {
            background: rgba(237, 66, 69, .12);
            color: var(--red)
        }

        .sug-text {
            font-size: .95rem;
            margin-bottom: 8px;
            line-height: 1.5
        }

        .sug-meta {
            display: flex;
            gap: 16px;
            color: var(--dim);
            font-size: .8rem
        }

        .empty {
            text-align: center;
            padding: 40px;
            color: var(--dim);
            font-size: .95rem
        }

        .loading {
            text-align: center;
            padding: 60px;
            color: var(--dim)
        }

        @media(max-width:600px) {
            .container {
                padding: 16px
            }

            .guild-header {
                flex-direction: column;
                text-align: center
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr)
            }
        }
    </style>
</head>

<body>
    <div class="top-bar">
        <h1>Max Bot <span>Dashboard</span></h1>
        <a href="/" class="back-btn">â† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </div>
    <div class="container" id="app">
        <div class="loading" id="loading">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙŠØ±ÙØ±...</div>
    </div>
    <script>
        const params = new URLSearchParams(window.location.search);
        const guildId = params.get('guild');
        if (!guildId) { document.getElementById('app').innerHTML = '<div class="empty">âŒ Ø­Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ±ÙØ±: ?guild=GUILD_ID</div>'; }
        else {
            fetch('/api/dashboard/' + guildId).then(r => r.json()).then(d => {
                if (d.error) { document.getElementById('app').innerHTML = '<div class="empty">âŒ Ø§Ù„Ø³ÙŠØ±ÙØ± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯</div>'; return; }
                const statusMap = { pending: ['â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±', 'pending'], approved: ['âœ… Ù…Ù‚Ø¨ÙˆÙ„', 'approved'], rejected: ['âŒ Ù…Ø±ÙÙˆØ¶', 'rejected'] };
                const settingsList = [
                    ['Ø§Ù„Ø¨Ø±ÙŠÙÙƒØ³', d.settings.prefix, 'tag'],
                    ['Ø§Ù„ØªØ±Ø­ÙŠØ¨', d.settings.welcome_enabled, 'toggle'],
                    ['Ø§Ù„ÙˆØ¯Ø§Ø¹', d.settings.leave_enabled, 'toggle'],
                    ['Ø§Ù„Ù„ÙˆÙ‚', d.settings.log_enabled, 'toggle'],
                    ['Ø¶Ø¯ Ø§Ù„Ø³Ø¨Ø§Ù…', d.settings.antispam_enabled, 'toggle'],
                    ['Ø¶Ø¯ Ø§Ù„Ø±ÙŠØ¯', d.settings.antiraid_enabled, 'toggle'],
                    ['Ø§Ù„Ù„ÙÙ„Ø§Øª', d.settings.leveling_enabled, 'toggle']
                ];
                let html = `
                <div class="guild-header">
                    <div class="guild-icon">${d.icon ? '<img src="' + d.icon + '">' : d.name.charAt(0)}</div>
                    <div class="guild-info"><h2>${d.name}</h2><p>${d.members.toLocaleString()} Ø¹Ø¶Ùˆ Â· ${d.channels} Ù‚Ù†Ø§Ø© Â· ${d.roles} Ø±ÙˆÙ„</p></div>
                </div>
                <div class="stats-grid">
                    <div class="stat-box"><div class="num blue">${d.members.toLocaleString()}</div><div class="lbl">Ø¹Ø¶Ùˆ</div></div>
                    <div class="stat-box"><div class="num green">${d.channels}</div><div class="lbl">Ù‚Ù†Ø§Ø©</div></div>
                    <div class="stat-box"><div class="num yellow">${d.roles}</div><div class="lbl">Ø±ÙˆÙ„</div></div>
                    <div class="stat-box"><div class="num purple">${d.suggestions.length}</div><div class="lbl">Ø§Ù‚ØªØ±Ø§Ø­</div></div>
                </div>
                <div class="section"><h3>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3><div class="settings-grid">
                    ${settingsList.map(([name, val, type]) => type === 'toggle' ? `<div class="setting-item"><span class="name">${name}</span><span class="val ${val ? 'on' : 'off'}">${val ? 'Ù…ÙØ¹Ù„' : 'Ù…Ø¹Ø·Ù„'}</span></div>` : `<div class="setting-item"><span class="name">${name}</span><span class="val on">${val}</span></div>`).join('')}
                </div></div>`;
                if (d.topLevels.length) {
                    html += `<div class="section"><h3>ğŸ† Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙÙ„Ø§Øª</h3><div class="lb-list">
                    ${d.topLevels.slice(0, 10).map((u, i) => `<div class="lb-row"><span class="lb-rank">${i + 1}</span><div class="lb-av">${u.avatar ? '<img src="' + u.avatar + '">' : 'ğŸ‘¤'}</div><span class="lb-name">${u.username}</span><span class="lb-val">Lv.${u.level} (${u.xp} XP)</span></div>`).join('')}
                    </div></div>`;
                }
                if (d.topEconomy.length) {
                    html += `<div class="section"><h3>âœ¨ Ø£ØºÙ†Ù‰ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</h3><div class="lb-list">
                    ${d.topEconomy.slice(0, 10).map((u, i) => `<div class="lb-row"><span class="lb-rank">${i + 1}</span><div class="lb-av">${u.avatar ? '<img src="' + u.avatar + '">' : 'ğŸ‘¤'}</div><span class="lb-name">${u.username}</span><span class="lb-val">${(u.total || 0).toLocaleString()} âœ¨</span></div>`).join('')}
                    </div></div>`;
                }
                if (d.suggestions.length) {
                    html += `<div class="section"><h3>ğŸ’¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</h3><div class="sug-list">
                    ${d.suggestions.map(s => { const [lbl, cls] = statusMap[s.status] || ['â³', 'pending']; return `<div class="sug-card"><div class="sug-top"><span class="sug-id">#${s.id}</span><span class="sug-status ${cls}">${lbl}</span></div><p class="sug-text">${s.text}</p><div class="sug-meta"><span>ğŸ‘ ${s.votes_up}</span><span>ğŸ‘ ${s.votes_down}</span><span>Ø¨ÙˆØ§Ø³Ø·Ø© ${s.username}</span></div></div>`; }).join('')}
                    </div></div>`;
                } else {
                    html += '<div class="section"><h3>ğŸ’¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</h3><div class="empty">ğŸ“­ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¨Ø¹Ø¯</div></div>';
                }
                document.getElementById('app').innerHTML = html;
            }).catch(() => { document.getElementById('app').innerHTML = '<div class="empty">âš ï¸ ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>'; });
        }
    </script>
</body>

</html>